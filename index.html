<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECO 2D LIVE - Professional Database Sync</title>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <style>
        :root {
            --primary-blue: #1a2a6c;
            --accent-red: #b21f1f;
            --gold: #fdbb2d;
            --success-green: #2ecc71;
            --dark-navy: #0b1426;
            --glass: rgba(255, 255, 255, 0.15);
        }

        body { font-family: 'Segoe UI', Roboto, sans-serif; background: #f0f2f5; margin: 0; overflow-x: hidden; }
        .app-container { width: 100%; max-width: 450px; background: white; min-height: 100vh; margin: 0 auto; position: relative; padding-bottom: 80px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); }

        /* Header */
        .header { background: linear-gradient(135deg, var(--primary-blue), var(--accent-red), var(--gold)); color: white; padding: 25px 20px 35px; text-align: center; border-bottom-left-radius: 40px; border-bottom-right-radius: 40px; position: relative; }
        .next-btn { position: absolute; top: 18px; right: 18px; background: rgba(255, 255, 255, 0.25); color: white; border: 1px solid rgba(255,255,255,0.4); padding: 7px 15px; border-radius: 25px; cursor: pointer; font-size: 11px; font-weight: bold; backdrop-filter: blur(5px); z-index: 100; }
        
        .logo-box { width: 75px; height: 75px; background: white; border-radius: 20px; margin: 0 auto 12px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-shadow: 0 5px 15px rgba(0,0,0,0.3); border: 2px solid var(--gold); }
        .logo-main { color: var(--primary-blue); font-size: 18px; font-weight: 900; line-height: 1; }
        .logo-sub { color: var(--accent-red); font-size: 10px; font-weight: bold; }

        .market-status { font-size: 12px; background: rgba(0,255,0,0.15); padding: 5px 18px; border-radius: 25px; display: inline-block; color: #00ff00; font-weight: bold; border: 1px solid rgba(0,255,0,0.3); margin-bottom: 10px; }
        .clock-area { font-family: 'Courier New', monospace; font-size: 26px; font-weight: bold; margin-bottom: 5px; }
        
        /* Number Display */
        .number-box { border: 2px solid rgba(255,255,255,0.6); padding: 15px; width: 85%; margin: 0 auto 15px; border-radius: 15px; background: rgba(0,0,0,0.15); backdrop-filter: blur(8px); }
        .live-number { font-size: 100px; font-weight: 900; margin: 0; display: block; line-height: 1; transition: 0.3s; }
        .shuffling { color: var(--gold); text-shadow: 0 0 25px rgba(253, 187, 45, 0.8); }
        .fixed { color: white; animation: fadeIn 0.8s ease; }
        @keyframes fadeIn { from { opacity: 0.5; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }

        .set-val-bar { font-size: 17px; font-weight: 800; color: white; letter-spacing: 0.5px; }

        /* Tables */
        .content { padding: 20px 15px; }
        .section-title { border-left: 5px solid var(--accent-red); padding-left: 12px; margin: 25px 0 12px; font-weight: 800; color: var(--primary-blue); font-size: 18px; }
        .res-table { width: 100%; border-collapse: collapse; text-align: center; background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 8px 25px rgba(0,0,0,0.05); }
        .res-table thead th { background: var(--primary-blue); color: white; padding: 14px 5px; font-size: 11px; text-transform: uppercase; }
        .res-table td { padding: 16px 5px; border-bottom: 1px solid #f2f2f2; font-weight: bold; font-size: 15px; }

        /* Analysis Page */
        #analysis-page { display: none; background: var(--dark-navy); color: white; min-height: 100vh; padding: 20px; }
        .stats-card { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        .stat-item { background: var(--glass); padding: 18px; border-radius: 15px; text-align: center; }
        .stat-value { font-size: 22px; font-weight: bold; color: var(--gold); }

        /* Footer */
        .footer-news { position: fixed; bottom: 0; width: 100%; max-width: 450px; background: #000; color: #00ff00; height: 45px; display: flex; align-items: center; overflow: hidden; border-top: 2px solid var(--accent-red); z-index: 100; }
        .news-scroll { white-space: nowrap; animation: news-move 45s linear infinite; font-size: 13px; }
        @keyframes news-move { 0% { transform: translateX(100%); } 100% { transform: translateX(-150%); } }
    </style>
</head>
<body>

<div class="app-container">
    <div id="home-page">
        <button class="next-btn" onclick="togglePage('analysis-page')">ANALYSIS ‚ûî</button>
        <div class="header">
            <div class="logo-box"><span class="logo-main">ECO</span><span class="logo-sub">2D LIVE</span></div>
            <div class="market-status" id="m-status">‚óè Market Open</div><br>
            <div id="live-date" style="font-size:14px; opacity:0.9; margin-bottom:5px;">---</div>
            <div class="clock-area" id="live-clock">00:00:00</div>
            
            <div class="number-box">
                <span id="num" class="live-number shuffling">--</span>
            </div>
            
            <div class="set-val-bar">
                SET: <span id="h-set">----.--</span> | VAL: <span id="h-val">-----.--</span>
            </div>
        </div>

        <div class="content">
            <div class="section-title">LIVE RESULTS</div>
            <table class="res-table">
                <thead><tr><th>Time</th><th>Set</th><th>Value</th><th>2D</th><th>Tip</th></tr></thead>
                <tbody>
                    <tr style="background:#f8faff"><td>12:01 PM</td><td id="m-set">--</td><td id="m-val">--</td><td id="m-2d" style="color:var(--accent-red); font-size:20px;">--</td><td id="m-tip" style="color:var(--success-green)">--</td></tr>
                    <tr style="background:#fffcf8"><td>04:30 PM</td><td id="e-set">--</td><td id="e-val">--</td><td id="e-2d" style="color:var(--accent-red); font-size:20px;">--</td><td id="e-tip" style="color:var(--success-green)">--</td></tr>
                </tbody>
            </table>
            <div class="section-title">WEEKLY HISTORY</div>
            <table class="res-table"><tbody id="week-body"></tbody></table>
        </div>
    </div>

    <div id="analysis-page">
        <button onclick="togglePage('home-page')" style="background:var(--glass); color:white; border:1px solid #444; padding:8px 18px; border-radius:10px; cursor:pointer; font-weight:bold;">‚ûî Back Home</button>
        <div id="chart-main" style="margin-top:25px;"></div>
        <div class="stats-card">
            <div class="stat-item"><div style="font-size:10px; color:#999;">Daily High</div><div class="stat-value" id="d-high">--</div></div>
            <div class="stat-item"><div style="font-size:10px; color:#999;">Daily Low</div><div class="stat-value" id="d-low">--</div></div>
        </div>
    </div>

    <div class="footer-news">
        <div style="background:var(--accent-red); color:white; padding:0 12px; height:100%; display:flex; align-items:center; font-size:11px; font-weight:bold; z-index:10;">INFO</div>
        <div class="news-scroll">üî• ECO 2D Live Professional Stock Market.Your investment will benefit you in the future. You just need to make the right choices and invest wisely. Good luck, my friend. üî•</div>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = { databaseURL: "https://database-15457-default-rtdb.firebaseio.com/" };
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    let dbData = {};

    window.togglePage = (id) => {
        document.getElementById('home-page').style.display = id === 'home-page' ? 'block' : 'none';
        document.getElementById('analysis-page').style.display = id === 'analysis-page' ? 'block' : 'none';
        if(id === 'analysis-page') window.dispatchEvent(new Event('resize'));
    };

    // --- Shuffling Engine (Smart Sync with DB) ---
    function runLiveEngine() {
        const numEl = document.getElementById('num');
        
        // Database ·ÄÄ Result ·ÄÄ·Ä≠·ÄØ Fixed ·Äú·ÄØ·Äï·Ä∫·Äë·Ä¨·Ä∏·Äõ·ÄÑ·Ä∫ Shuffling ·ÄÄ·Ä≠·ÄØ ·Äõ·Äï·Ä∫·Äô·Äö·Ä∫
        if(dbData.live_status && dbData.live_status.includes("fixed")) {
            if(dbData.live_status === "fixed_m") {
                updateUI(dbData.morning_set, dbData.morning_val, dbData.morning_2d, "fixed");
            } else if(dbData.live_status === "fixed_e") {
                updateUI(dbData.evening_set, dbData.evening_val, dbData.evening_2d, "fixed");
            }
        } else {
            // ·Äô·Äü·ÄØ·Äê·Ä∫·Äõ·ÄÑ·Ä∫ ·Äï·ÄØ·Ä∂·Äô·Äæ·Äî·Ä∫·Ä°·Äê·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏ Shuffle ·ÄÜ·ÄÄ·Ä∫·Äú·ÄØ·Äï·Ä∫·Äô·Äö·Ä∫
            const now = new Date();
            const seed = Math.floor(now.getTime() / 4000); 
            let x = (seed * 1103515245 + 12345) % 2147483647;
            
            const sInt = Math.floor((x / 2147483647) * 100) + 1340;
            const sDec = Math.floor(Math.random() * 100).toString().padStart(2, '0');
            const vInt = Math.floor(((x+88) / 2147483647) * 4500) + 36500;
            const vDec = Math.floor(Math.random() * 100).toString().padStart(2, '0');
            
            const finalS = `${sInt}.${sDec}`;
            const finalV = `${vInt}.${vDec}`;
            const finalD = finalS.split('.')[0].slice(-1) + finalV.split('.')[0].slice(-1);

            updateUI(finalS, finalV, finalD, "shuffling");
        }
        
        setTimeout(runLiveEngine, Math.floor(Math.random() * 5000) + 3000);
    }

    function updateUI(s, v, d, mode) {
        const num = document.getElementById('num');
        num.innerText = d || "--";
        num.className = `live-number ${mode}`;
        
        // ·Äí·Äø·Äô·ÄÄ·Ä≠·Äî·Ä∫·Ä∏·Äï·Ä´·Äõ·ÄÑ·Ä∫ ·Äï·Ä´·Äê·Ä≤·Ä∑·Ä°·Äê·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏·Åä ·Äô·Äï·Ä´·Äõ·ÄÑ·Ä∫ .00 ·Äë·Ää·Ä∑·Ä∫·Äï·Äº·Äô·Äö·Ä∫
        document.getElementById('h-set').innerText = s ? (s.includes('.') ? s : s + ".00") : "----.--";
        document.getElementById('h-val').innerText = v ? (v.includes('.') ? v : v + ".00") : "-----.--";
        
        if(mode === "shuffling") {
            document.getElementById('d-high').innerText = (parseFloat(s) + 1.2).toFixed(2);
            document.getElementById('d-low').innerText = (parseFloat(s) - 0.8).toFixed(2);
        }
    }

    // --- Firebase Sync ---
    onValue(ref(db, '/'), (snap) => {
        dbData = snap.val() || {};
        
        document.getElementById('m-set').innerText = dbData.morning_set || "--";
        document.getElementById('m-val').innerText = dbData.morning_val || "--";
        document.getElementById('m-2d').innerText = dbData.morning_2d || "--";
        document.getElementById('m-tip').innerText = dbData.morning_tip || "--";
        document.getElementById('e-set').innerText = dbData.evening_set || "--";
        document.getElementById('e-val').innerText = dbData.evening_val || "--";
        document.getElementById('e-2d').innerText = dbData.evening_2d || "--";
        document.getElementById('e-tip').innerText = dbData.evening_tip || "--";

        const status = document.getElementById('m-status');
        if(dbData.live_status && dbData.live_status.includes("fixed")) {
            status.innerText = "‚óè Result Fixed"; status.style.color = "#ffcc00";
        } else {
            status.innerText = "‚óè Market Open"; status.style.color = "#00ff00";
        }

        let rows = ""; ['mon','tue','wed','thu','fri','sat','sun'].forEach(day => {
            rows += `<tr><td style="font-size:11px; background:#f5f5f5">${day.toUpperCase()}</td><td>${dbData[day+'_m']||'--'}</td><td>${dbData[day+'_e']||'--'}</td></tr>`;
        });
        document.getElementById('week-body').innerHTML = rows;
    });

    runLiveEngine();

    setInterval(() => {
        const n = new Date();
        document.getElementById('live-clock').innerText = n.toLocaleTimeString([], { hour12: true });
        document.getElementById('live-date').innerText = n.toDateString();
    }, 1000);

    // Chart
    let chart = new ApexCharts(document.querySelector("#chart-main"), {
        series: [{ data: [] }],
        chart: { type: 'candlestick', height: 320, toolbar: {show:false}, animations: {enabled: false} },
        plotOptions: { candlestick: { colors: { upward: '#2ecc71', downward: '#e74c3c' } } },
        xaxis: { labels: {show: false} }
    });
    chart.render();
    setInterval(() => {
        let d = []; for(let i=0; i<15; i++) {
            let base = Math.floor(Math.random()*50) + 1300;
            d.push({x: i, y:[base, base+5, base-5, base+2]});
        }
        chart.updateSeries([{data: d}]);
    }, 5000);
</script>
</body>
</html>